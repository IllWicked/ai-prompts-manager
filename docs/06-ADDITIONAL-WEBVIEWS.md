# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ WebView

[‚Üê –ù–∞–∑–∞–¥ –∫ INDEX](INDEX.md)

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                       Main Window                            ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                   ‚îÇ   Claude WebView (1-3)                  ‚îÇ
‚îÇ   Main WebView    ‚îÇ   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ   (index.html)    ‚îÇ   ‚îÇ        claude.ai                ‚îÇ   ‚îÇ
‚îÇ                   ‚îÇ   ‚îÇ                                 ‚îÇ   ‚îÇ
‚îÇ                   ‚îÇ   ‚îÇ   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ   ‚îÇ
‚îÇ                   ‚îÇ   ‚îÇ   ‚îÇ   Downloads WebView     ‚îÇ   ‚îÇ   ‚îÇ
‚îÇ                   ‚îÇ   ‚îÇ   ‚îÇ   (downloads.html)      ‚îÇ   ‚îÇ   ‚îÇ
‚îÇ                   ‚îÇ   ‚îÇ   ‚îÇ   320x360               ‚îÇ   ‚îÇ   ‚îÇ
‚îÇ                   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ   ‚îÇ
‚îÇ                   ‚îÇ   ‚îÇ                                 ‚îÇ   ‚îÇ
‚îÇ                   ‚îÇ   ‚îÇ   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê          ‚îÇ   ‚îÇ
‚îÇ                   ‚îÇ   ‚îÇ   ‚îÇ Toolbar WebView  ‚îÇ          ‚îÇ   ‚îÇ
‚îÇ                   ‚îÇ   ‚îÇ   ‚îÇ (toolbar.html)   ‚îÇ          ‚îÇ   ‚îÇ
‚îÇ                   ‚îÇ   ‚îÇ   ‚îÇ 152x44           ‚îÇ          ‚îÇ   ‚îÇ
‚îÇ                   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò          ‚îÇ   ‚îÇ
‚îÇ                   ‚îÇ   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## toolbar.html (~123 —Å—Ç—Ä–æ–∫–∏)

–ü–ª–∞–≤–∞—é—â–∏–π —Ç—É–ª–±–∞—Ä –Ω–∞–¥ Claude WebView.

### –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ

- **–†–∞–∑–º–µ—Ä:** 152x44 –ø–∏–∫—Å–µ–ª–µ–π
- **–ü–æ–∑–∏—Ü–∏—è:** –ø–æ —Ü–µ–Ω—Ç—Ä—É Claude WebView, –≤–Ω–∏–∑—É
- **Z-Order:** –≤—ã—à–µ Claude WebView

### –ö–Ω–æ–ø–∫–∏

| –ö–Ω–æ–ø–∫–∞ | ID | Tauri Command | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|-----|---------------|----------|
| ‚Üê | `btn-back` | `toolbar_back` | –ù–∞–∑–∞–¥ –≤ –∏—Å—Ç–æ—Ä–∏–∏ |
| ‚Üí | `btn-forward` | `toolbar_forward` | –í–ø–µ—Ä—ë–¥ –≤ –∏—Å—Ç–æ—Ä–∏–∏ |
| ‚Üª | `btn-reload` | `toolbar_reload` | –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É |
| ‚Üì | `btn-downloads` | `show_downloads` / `hide_downloads` | Toggle popup –∑–∞–≥—Ä—É–∑–æ–∫ |

### –°–æ–±—ã—Ç–∏—è

```javascript
// –ó–∞–∫—Ä—ã—Ç–∏–µ popup –ø—Ä–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–∏ –æ—Ç downloads webview
listen('downloads-closed', () => {
    isPopupOpen = false;
    btnDownloads.classList.remove('active');
});
```

> **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ó–∞–∫—Ä—ã—Ç–∏–µ popup –ø—Ä–∏ –∫–ª–∏–∫–µ –≤ Claude WebView —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —á–µ—Ä–µ–∑ `setupGlobalClickListener()` –≤ `claude_helpers.js`, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞–ø—Ä—è–º—É—é –≤—ã–∑—ã–≤–∞–µ—Ç `invoke('hide_downloads')`.

### –°—Ç–∏–ª–∏

- –ü–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω (#2D2D2D)
- Rounded corners (10px)
- Hover —ç—Ñ—Ñ–µ–∫—Ç—ã –Ω–∞ –∫–Ω–æ–ø–∫–∞—Ö
- Active state –¥–ª—è –∫–Ω–æ–ø–∫–∏ Downloads

---

## downloads.html (~590 —Å—Ç—Ä–æ–∫)

–ú–µ–Ω–µ–¥–∂–µ—Ä –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ (popup).

### –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ

- **–†–∞–∑–º–µ—Ä:** 320x360 –ø–∏–∫—Å–µ–ª–µ–π
- **–ü–æ–∑–∏—Ü–∏—è:** –Ω–∞–¥ toolbar
- **Z-Order:** –≤—ã—à–µ toolbar

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```html
<div class="downloads-popup">
    <div class="downloads-header">
        <span class="downloads-title">–ó–∞–≥—Ä—É–∑–∫–∏</span>
        <div class="header-actions">
            <button class="send-selected-btn">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
            <button class="delete-all-btn">–£–¥–∞–ª–∏—Ç—å –≤—Å–µ</button>
        </div>
    </div>
    <div class="downloads-list">
        <!-- –°–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ -->
    </div>
</div>
```

### –§—É–Ω–∫—Ü–∏–∏

| –§—É–Ω–∫—Ü–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `loadDownloads()` | –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ –∏–∑ `get_downloads_log` |
| `renderDownloads()` | –û—Ç—Ä–∏—Å–æ–≤–∫–∞ —Å–ø–∏—Å–∫–∞ —Ñ–∞–π–ª–æ–≤ |
| `openFile(path)` | –û—Ç–∫—Ä—ã—Ç—å —Ñ–∞–π–ª –≤ —Å–∏—Å—Ç–µ–º–µ |
| `sendToClaude(filePath)` | –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ñ–∞–π–ª –≤ Claude |
| `sendSelectedToClaude()` | –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã |
| `deleteDownload(path)` | –£–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å—å –∏–∑ –ª–æ–≥–∞ |
| `deleteAllDownloads()` | –û—á–∏—Å—Ç–∏—Ç—å –≤–µ—Å—å –ª–æ–≥ |
| `closePopup()` | –ó–∞–∫—Ä—ã—Ç—å popup |

### –í—ã–±–æ—Ä —Ñ–∞–π–ª–æ–≤

```javascript
// Shift+Click –¥–ª—è –¥–∏–∞–ø–∞–∑–æ–Ω–∞
if (e.shiftKey && lastClickedIndex !== -1) {
    const start = Math.min(lastClickedIndex, index);
    const end = Math.max(lastClickedIndex, index);
    for (let i = start; i <= end; i++) {
        selectedFiles.add(downloads[i].file_path);
    }
}

// –û–±—ã—á–Ω—ã–π –∫–ª–∏–∫ ‚Äî toggle selection
if (selectedFiles.has(filePath)) {
    selectedFiles.delete(filePath);
} else {
    selectedFiles.add(filePath);
}
```

### –ò–∫–æ–Ω–∫–∏

–û–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –ø–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—é —Ñ–∞–π–ª–∞:

| –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ | –ò–∫–æ–Ω–∫–∞ |
|------------|--------|
| `.zip`, `.rar`, `.7z`, `.tar`, `.gz` | üì¶ Archive |
| `.doc`, `.docx`, `.pdf`, `.txt`, `.md`, `.html` | üìÑ Document |
| `.jpg`, `.jpeg`, `.png`, `.gif`, `.svg`, `.webp` | üñº Image |
| `.mp4`, `.mov`, `.avi`, `.mkv` | üé¨ Video |
| `.mp3`, `.wav`, `.flac`, `.ogg` | üéµ Audio |
| `.py`, `.js`, `.ts`, `.rs`, `.json` | üíª Code |
| `.xls`, `.xlsx`, `.csv` | üìä Spreadsheet |
| `.ppt`, `.pptx` | üìΩ Presentation |
| –û—Å—Ç–∞–ª—å–Ω—ã–µ | üìÅ File |

### –°–æ–±—ã—Ç–∏—è

```javascript
// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞
listen('refresh-downloads', () => loadDownloads());

// –ù–∞—á–∞–ª–æ –∑–∞–≥—Ä—É–∑–∫–∏
listen('download-started', (event) => {
    // –ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä
});

// –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏
listen('download-finished', (event) => {
    loadDownloads();
});
```

---

## Z-Order –∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–µ

### –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ Claude WebView (—Ç–∞–±—ã 2 –∏ 3) –æ–Ω —Å–æ–∑–¥–∞—ë—Ç—Å—è –ü–û–í–ï–†–• toolbar –∏ downloads.

### –†–µ—à–µ–Ω–∏–µ

–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è Claude WebView –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `recreate_toolbar()`:

```rust
fn recreate_toolbar(app: &AppHandle) -> Result<(), String> {
    // 1. –ó–∞–∫—Ä—ã–≤–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ
    if let Some(toolbar) = app.get_webview("toolbar") {
        let _ = toolbar.close();
    }
    if let Some(downloads) = app.get_webview("downloads") {
        let _ = downloads.close();
    }
    
    // 2. –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞
    std::thread::sleep(std::time::Duration::from_millis(10));
    
    // 3. –°–æ–∑–¥–∞—ë–º –∑–∞–Ω–æ–≤–æ ‚Äî —Ç–µ–ø–µ—Ä—å –æ–Ω–∏ –ø–æ–≤–µ—Ä—Ö
    window.add_child(
        WebviewBuilder::new("toolbar", ...),
        ...
    )?;
    
    window.add_child(
        WebviewBuilder::new("downloads", ...),
        ...
    )?;
    
    Ok(())
}
```

---

## Tauri Commands (Toolbar)

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `toolbar_back` | –ù–∞–≤–∏–≥–∞—Ü–∏—è –Ω–∞–∑–∞–¥ –≤ Claude WebView |
| `toolbar_forward` | –ù–∞–≤–∏–≥–∞—Ü–∏—è –≤–ø–µ—Ä—ë–¥ |
| `toolbar_reload` | –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã |
| `show_downloads` | –ü–æ–∫–∞–∑–∞—Ç—å popup –∑–∞–≥—Ä—É–∑–æ–∫ |
| `hide_downloads` | –°–∫—Ä—ã—Ç—å popup |
| `forward_scroll` | –ü—Ä–æ–±—Ä–æ—Å —Å–∫—Ä–æ–ª–ª–∞ –Ω–∞ Claude |
| `forward_click` | –ü—Ä–æ–±—Ä–æ—Å –∫–ª–∏–∫–∞ –Ω–∞ Claude |

---

## Tauri Commands (Downloads)

| –ö–æ–º–∞–Ω–¥–∞ | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã | –í–æ–∑–≤—Ä–∞—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|-----------|---------|----------|
| `get_downloads_log` | ‚Äî | `Vec<DownloadEntry>` | –°–ø–∏—Å–æ–∫ –∑–∞–≥—Ä—É–∑–æ–∫ |
| `add_download_entry` | `filename, file_path` | ‚Äî | –î–æ–±–∞–≤–∏—Ç—å –∑–∞–ø–∏—Å—å |
| `delete_download` | `file_path` | `bool` | –£–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å—å |
| `delete_all_downloads` | ‚Äî | `u32` | –£–¥–∞–ª–∏—Ç—å –≤—Å–µ |
| `open_file` | `file_path` | ‚Äî | –û—Ç–∫—Ä—ã—Ç—å –≤ —Å–∏—Å—Ç–µ–º–µ |
| `read_file_for_attachment` | `path` | `FileData` | –ß–∏—Ç–∞—Ç—å –¥–ª—è Claude |

‚Üí –°—Ç—Ä—É–∫—Ç—É—Ä–∞ `DownloadEntry`: [03-BACKEND.md](03-BACKEND.md#downloads-manager)

---

## –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- [01-OVERVIEW.md](01-OVERVIEW.md) ‚Äî Multi-WebView –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- [03-BACKEND.md](03-BACKEND.md) ‚Äî Tauri commands
- [05-FEATURES.md](05-FEATURES.md) ‚Äî Downloads Manager
